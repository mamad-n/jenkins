stage('Build') {
    node {
        sh 'echo from build'
        stage ('inner build')
        {
            checkout scm
            sh 'echo from innner build'
        }
        stage ('inner test')
        {
            sh 'echo from inner test'
        }
    }
}

stage('Test') {
    node('linux') {
        checkout scm
        try {
            sh 'echo from linux  check'
        }
        finally {
            sh 'echo end of finally'
        }
    }
    node('windows') {
        checkout scm
        try {
            bat 'echo from windows check'
        }
        finally {
            sh 'echo end of finally'
            
        }
    }
}